Public day1 As String
Public cudate As Date
Public stdate As Date
Public endate As Date
Public MyFile As Variant
Public Flnm As String
Public Wb2 As Workbook
Public Repnm As String
Public Repcnt As Integer
Public Wscnt As Integer
Public Rowcnt As Long
Public Rowinc As Long
Public EDTEST As Integer
Public RepTitle As String

Private Sub Weekdate1()
cudate = Date
'stdate = cudate
End Sub
Sub Common_Global()
Repcnt = 1
Repnm = " "

Application.ScreenUpdating = False
Application.DisplayAlerts = False
Wscnt = ThisWorkbook.Worksheets.Count
If Wscnt > 1 Then
ThisWorkbook.Worksheets(1).Delete
ThisWorkbook.Worksheets(2).Delete
End If
MsgBox "Please select the Common&Global Report file"
OpenCCreport:
MyFile = Application.GetOpenFilename()
If MyFile = False Then
MsgBox "No file is selected. Please select the CC-Report file"
GoTo OpenCCreport
Else
Workbooks.Open (MyFile)
End If
    '----------File name from path-------
    Flnm = Mid(Mid(MyFile, InStrRev(MyFile, "/") + 1), InStrRev(MyFile, "\") + 1)
    
    '------Copy raw data to report sheet
    Set Wb2 = Application.Workbooks.Open(Flnm)
    ThisWorkbook.Sheets(1).UsedRange.Clear
    Wb2.Sheets(1).UsedRange.Copy ThisWorkbook.Sheets(1).Cells(1, 1)
    '---------Close raw data file
    Wb2.Close
    ActiveSheet.Name = "Common_reports_merged"
    Range("A1").Select
    Selection.AutoFilter
    Rowcnt = Range("A" & Rows.Count).End(xlUp).Row
     ActiveSheet.Range("$A$1:$AO$" & Rowcnt).AutoFilter Field:=24, Criteria1:=Array( _
        "Disaster Recovery", "Enterprise Servers", "Global Messaging Operations", "Open Systems Database", "SCCM", _
        "SharePoint", "Webhosting"), Operator:=xlFilterValues
    Range("A1").Select
    Range(Selection, ActiveCell.SpecialCells(xlLastCell)).Select
    Selection.Copy
    Sheets.Add After:=ActiveSheet
    ActiveSheet.Paste
    ActiveSheet.Name = "Common_Report"
    Sheets("Common_reports_merged").Select
    Selection.Delete
    ActiveSheet.Cells(1, 1).Select
    Sheets("Common_report").Select
    Cells(1, 1).Select
    ActiveCell.EntireRow.Copy
    Sheets("Common_reports_merged").Select
    Cells(1, 1).Insert Shift:=xlDown
    ActiveSheet.Name = "Global_Report"
    Worksheets("Global_Report").Move After:=Worksheets("Common_Report")
    Call CC_Report_Enterprise_Servers
End Sub

Private Sub CC_Report_Enterprise_Servers()

    Sheets("Common_report").Select
    ActiveSheet.Name = "temp1"
    Rowcnt = Range("A" & Rows.Count).End(xlUp).Row
    ActiveWorkbook.Worksheets("temp1").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("temp1").Sort.SortFields.Add Key:=Range( _
        "F2:F" & Rowcnt), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortNormal
    With ActiveWorkbook.Worksheets("temp1").Sort
        .SetRange Range("A1:AO" & Rowcnt)
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    stdate = Format(ActiveSheet.Cells(2, 6), "mm/dd/yyyy")
    'endate = Format(ActiveSheet.Cells(Rowcnt, 6), "mm/dd/yyyy")
    endate = stdate + 10
    '---------Close raw data file
    'Wb2.Close
    '-----------Rename report rawdata sheet
    ThisWorkbook.Sheets(1).Select
    ActiveSheet.Name = "CC-Report-Enterprise Servers"
    '-------------------------------
    ' -----Bablu Macro Here---------
    Call EDT_EST
    '-------------------------------
    ActiveSheet.Cells(1, 6) = "Last Backup OK?"
    ActiveSheet.Cells(1, 7) = "Last Good Backup"
    Call Change_Date
    Call SRVInterrupt
    Call SRV_List
    Call Opentxtfile
    Call Vlook_UP
    Call Shrt_JEIB
    Call Rowhigh
    'Call Stand_Change
    Worksheets("txtfile").Delete
    
    Application.ScreenUpdating = True
    Application.DisplayAlerts = True
    Call Conflict_Report
    
    End Sub
Private Sub Change_Date()
Dim Fdate As Date
Rowcnt = Range("A" & Rows.Count).End(xlUp).Row
Rowinc = 2
'MsgBox N
Call Weekdate1
Do Until Rowinc = Rowcnt + 1
Fdate = ActiveSheet.Cells(Rowinc, 11)
ActiveSheet.Cells(Rowinc, 12) = Format(ActiveSheet.Cells(Rowinc, 12), "Long Time")
If ActiveSheet.Cells(Rowinc, 12) > TimeSerial(21, 0, 0) Or ActiveSheet.Cells(Rowinc, 12) = TimeSerial(21, 0, 0) Then
Fdate = Fdate - 1
ActiveSheet.Cells(Rowinc, 11) = Fdate
End If
If ActiveSheet.Cells(Rowinc, 11) < stdate Then
ActiveSheet.Cells(Rowinc, 1).EntireRow.Delete
Rowcnt = Range("A" & Rows.Count).End(xlUp).Row
Rowinc = Rowinc - 1
End If
If ActiveSheet.Cells(Rowinc, 2) = "initiative" Then
ActiveSheet.Cells(Rowinc, 1).EntireRow.Delete
Rowcnt = Range("A" & Rows.Count).End(xlUp).Row
Rowinc = Rowinc - 1
End If
Rowinc = Rowinc + 1
Loop
'---Sort by Start Date
ActiveSheet.Sort.SortFields.Clear
ActiveSheet.UsedRange.Sort Key1:=Range("K2"), Order1:=xlAscending, Header:=xlYes
End Sub

Private Sub Opentxtfile()
Sheets.Add After:=Sheets(Sheets.Count)
MsgBox "Please select the BackupVerify text file"
Opentxt:
MyFile = Application.GetOpenFilename()
If MyFile = False Then
MsgBox "No file selected. Please select the text file"
GoTo Opentxt
Else
    With ActiveSheet.QueryTables.Add(Connection:= _
        "TEXT;" & MyFile, _
        Destination:=Range("$A$1"))
        .Name = "backupverify"
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = True
        .RefreshOnFileOpen = False
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .TextFilePromptOnRefresh = False
        .TextFilePlatform = 437
        .TextFileStartRow = 1
        .TextFileParseType = xlDelimited
        .TextFileTextQualifier = xlTextQualifierDoubleQuote
        .TextFileConsecutiveDelimiter = False
        .TextFileTabDelimiter = False
        .TextFileSemicolonDelimiter = False
        .TextFileCommaDelimiter = False
        .TextFileSpaceDelimiter = False
        .TextFileOtherDelimiter = ","
        .TextFileColumnDataTypes = Array(1, 1, 1, 1, 1, 1, 1, 1, 1, 1)
        .TextFileTrailingMinusNumbers = True
        .Refresh BackgroundQuery:=False
    End With
End If
ActiveSheet.Name = "txtfile"
Call GoingAway
End Sub
Private Sub GoingAway()
Dim i As Integer
Rowcnt = Range("A" & Rows.Count).End(xlUp).Row
i = 2
'MsgBox N
Do Until i = Rowcnt + 1
'fd = ActiveSheet.Cells(i, 1)
'MsgBox ActiveSheet.Cells(i, 4)
If UCase(ActiveSheet.Cells(i, 4)) Like "*GOING*" Then
Rows(i).EntireRow.Delete
i = i - 1
Rowcnt = Rowcnt - 1
'N = Range("A" & Rows.Count).End(xlUp).Row
End If
i = i + 1
Loop
End Sub


Private Sub Vlook_UP()
Dim SrvName As String
Dim Lastback As Variant
Dim GoodBack As Date

Dim Rowcnt As Long
Dim Rowinc As Long
Worksheets("CC-Report-Enterprise Servers").Activate
Rowcnt = Range("A" & Rows.Count).End(xlUp).Row
Rowinc = 2
Do Until Rowinc = Rowcnt + 1
ActiveSheet.Cells(Rowinc, 6).Select
ActiveCell.FormulaR1C1 = "=VLOOKUP(RC[-4],txtfile!C[-5]:C[4],5,0)"
   
ActiveSheet.Cells(Rowinc, 7).Select
    ActiveCell.FormulaR1C1 = "=VLOOKUP(RC[-5],txtfile!C[-6]:C[3],10,0)"

Rowinc = Rowinc + 1

Loop
Columns("F:F").Select
Selection.Copy
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
Columns("G:G").Select
Selection.Copy
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
Columns("G:G").Select
    Selection.NumberFormat = "mm/dd/yy;@"
End Sub



Private Sub Shrt_JEIB()
Rowcnt = Range("A" & Rows.Count).End(xlUp).Row
    Cells.Select
    ActiveWorkbook.Worksheets("CC-Report-Enterprise Servers").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("CC-Report-Enterprise Servers").Sort.SortFields.Add Key:=Range( _
        "K1:K" & Rowcnt), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortNormal
    ActiveWorkbook.Worksheets("CC-Report-Enterprise Servers").Sort.SortFields.Add Key:=Range( _
        "E1:E" & Rowcnt), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortNormal
    ActiveWorkbook.Worksheets("CC-Report-Enterprise Servers").Sort.SortFields.Add Key:=Range( _
        "J1:J" & Rowcnt), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortTextAsNumbers
    ActiveWorkbook.Worksheets("CC-Report-Enterprise Servers").Sort.SortFields.Add Key:=Range( _
        "B1:B" & Rowcnt), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortNormal
    With ActiveWorkbook.Worksheets("CC-Report-Enterprise Servers").Sort
        .SetRange Range("A1:R" & Rowcnt)
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
       End With
       Rowinc = 1
    Cells(1, 1).Select
     '---Moving Service Interrupt Colmun
    Columns("R:R").Select
    Selection.Cut
    Columns("K:K").Select
    Selection.Insert Shift:=xlToRight
   
'ActiveSheet.Cells(1, 18).EntireColumn.Delete
ActiveSheet.Cells(Rowinc, 1) = "CC"
ActiveSheet.Cells(Rowinc, 2) = "Server"
ActiveSheet.Cells(Rowinc, 3) = "Env"
ActiveSheet.Cells(Rowinc, 4) = "Impact"
ActiveSheet.Cells(Rowinc, 5) = "Summary"
ActiveSheet.Cells(Rowinc, 6) = "Last Backup OK?"
ActiveSheet.Cells(Rowinc, 7) = "Last Good Backup"
ActiveSheet.Cells(Rowinc, 8) = "STD CC"
ActiveSheet.Cells(Rowinc, 9) = "Info Event"
ActiveSheet.Cells(Rowinc, 10) = "Implementer"
ActiveSheet.Cells(Rowinc, 11) = "Service interrupted?"
ActiveSheet.Cells(Rowinc, 12) = "Start Date"
ActiveSheet.Cells(Rowinc, 13) = "Start Time"
ActiveSheet.Cells(Rowinc, 14) = "End Date"
ActiveSheet.Cells(Rowinc, 15) = "End Time"
ActiveSheet.Cells(Rowinc, 16) = "Priority"
ActiveSheet.Cells(Rowinc, 17) = "Status"
ActiveSheet.Cells(Rowinc, 18) = "Requester"

ActiveSheet.Range(Cells(Rowinc, 1), Cells(Rowinc, 18)).Interior.Color = RGB(102, 102, 153)
ActiveSheet.Range(Cells(Rowinc, 1), Cells(Rowinc, 18)).Font.Color = RGB(255, 255, 255)
ActiveSheet.Range(Cells(Rowinc, 1), Cells(Rowinc, 18)).Font.Bold = True
ActiveSheet.Range(Cells(Rowinc, 1), Cells(Rowinc, 18)).Font.Size = 11
Call Makereport
End Sub

Private Sub Header_Text()
ActiveSheet.Cells(Rowinc, 1).Select
ActiveCell.EntireRow.Insert
ActiveCell.EntireRow.ClearFormats
ActiveSheet.Cells(Rowinc, 1) = "CC"
ActiveSheet.Cells(Rowinc, 2) = "Server"
ActiveSheet.Cells(Rowinc, 3) = "Env"
ActiveSheet.Cells(Rowinc, 4) = "Impact"
ActiveSheet.Cells(Rowinc, 5) = "Summary"
ActiveSheet.Cells(Rowinc, 6) = "Last Backup OK?"
ActiveSheet.Cells(Rowinc, 7) = "Last Good Backup"
ActiveSheet.Cells(Rowinc, 8) = "STD CC"
ActiveSheet.Cells(Rowinc, 9) = "Info Event"
ActiveSheet.Cells(Rowinc, 10) = "Implementer"
ActiveSheet.Cells(Rowinc, 11) = "Service interrupted?"
ActiveSheet.Cells(Rowinc, 12) = "Start Date"
ActiveSheet.Cells(Rowinc, 13) = "Start Time"
ActiveSheet.Cells(Rowinc, 14) = "End Date"
ActiveSheet.Cells(Rowinc, 15) = "End Time"
ActiveSheet.Cells(Rowinc, 16) = "Priority"
ActiveSheet.Cells(Rowinc, 17) = "Status"
ActiveSheet.Cells(Rowinc, 18) = "Requester"
ActiveSheet.Range(Cells(Rowinc, 1), Cells(Rowinc, 18)).Interior.Color = RGB(102, 102, 153)
ActiveSheet.Range(Cells(Rowinc, 1), Cells(Rowinc, 18)).Font.Color = RGB(255, 255, 255)
ActiveSheet.Range(Cells(Rowinc, 1), Cells(Rowinc, 18)).Font.Bold = True
ActiveSheet.Range(Cells(Rowinc, 1), Cells(Rowinc, 18)).Font.Size = 11
Rowinc = Rowinc + 1
Rowcnt = Range("A" & Rows.Count).End(xlUp).Row
End Sub
Private Sub Makereport()
Dim Headdate As Date
Rowcnt = Range("A" & Rows.Count).End(xlUp).Row
Rowinc = 2
Headdate = Date
'ActiveSheet.Range(Cells(1, 1), Cells(1, 9)).Interior.Color = RGB(255, 255, 153)
'ActiveSheet.Range(Cells(1, 1), Cells(1, 9)).Font.Bold = True
'ActiveSheet.Range(Cells(1, 1), Cells(1, 9)).Font.Size = 11
Headerloop:
Do While Rowinc < Rowcnt + 1
Headdate = ActiveSheet.Cells(Rowinc, 12)
If ActiveSheet.Cells(Rowinc, 12) <> ActiveSheet.Cells(Rowinc - 1, 12) Then
If Rowinc <> 2 Then Call Header_Text
ActiveSheet.Cells(Rowinc, 1).Select
ActiveCell.EntireRow.Insert
ActiveCell.EntireRow.ClearFormats
Range(Cells(Rowinc, 1), Cells(Rowinc, 18)).Merge
ActiveSheet.Cells(Rowinc, 1).Value = Format(Headdate, "dddd, mmmm dd, yyyy")
ActiveSheet.Cells(Rowinc, 1).Font.Bold = True
ActiveSheet.Cells(Rowinc, 1).Font.Size = 11
ActiveSheet.Cells(Rowinc, 1).Font.Color = RGB(0, 0, 0)
'ActiveSheet.Cells(u, 1).VerticalAlignment = xlJustify
ActiveSheet.Cells(Rowinc, 1).Interior.Color = RGB(255, 255, 153)
Rowcnt = Range("A" & Rows.Count).End(xlUp).Row
Rowinc = Rowinc + 1
End If
If ActiveSheet.Cells(Rowinc, 12) = ActiveSheet.Cells(Rowinc + 1, 12) Then
Rowinc = Rowinc + 1
GoTo Headerloop
End If
Rowinc = Rowinc + 1
Loop
'ActiveSheet.Range(Cells(1, 8), Cells(1, 9)).EntireColumn.Delete
ActiveSheet.UsedRange.Columns.AutoFit
ActiveSheet.Cells(1, 1).Select
ActiveCell.EntireRow.Insert
ActiveCell.EntireRow.Insert
ActiveCell.EntireRow.Insert
ActiveCell.EntireRow.Insert
ActiveCell.EntireRow.ClearFormats
Range(Cells(1, 1), Cells(1, 18)).Merge
ActiveSheet.Cells(1, 1).Interior.Color = RGB(204, 255, 255)
Range(Cells(1, 1), Cells(4, 18)).Merge
ActiveSheet.Cells(1, 1).Value = "Scheduled Change Control - Enterprise Servers" & Chr(10) & "Start Date: " _
& stdate & "      End Date: " & endate
ActiveSheet.Cells(1, 1).HorizontalAlignment = xlCenter
ActiveSheet.Cells(1, 1).VerticalAlignment = xlCenter
ActiveSheet.Cells(1, 1).Font.Name = "Calibri"
ActiveSheet.Cells(1, 1).Font.Size = 16
ActiveSheet.Cells(1, 1).RowHeight = 12.75
ActiveSheet.Cells(1, 1).Font.Bold = True
ActiveSheet.Cells(1, 1).Font.Color = RGB(0, 0, 0)
With ActiveSheet.UsedRange.Borders
      .LineStyle = xlContinuous
      .Weight = xlThin
      .ColorIndex = xlAutomatic
    End With
   
End Sub



Private Sub EDT_EST()
Selecmac:
EDTEST = InputBox("Press 1 for EDT or 2 for EST")
'MsgBox EDTEST
If EDTEST = 1 Then Call EDT
If EDTEST = 2 Then Call EST
If EDTEST < 1 Or EDTEST > 2 Then
MsgBox "Invalid Selection,Press 1 for EDT or 2 for EST"
GoTo Selecmac
End If
End Sub

Private Sub EDT()
MsgBox "You have selected EDT"
'
' Macro1 Macro
' Macro recorded 11/3/2009 by jakhoon
' Updated 11/20/2012 by jakhoon
' Updated 01/22/2014 by jakhoon

'
Dim i As Integer
Dim a, c As String

a = ActiveSheet.Name
i = 2
j = 2
k = 2


    Columns("D:D").Select
    Selection.Delete Shift:=xlToLeft
    Columns("D:D").EntireColumn.AutoFit
    Columns("E:E").EntireColumn.AutoFit
    Columns("E:E").Select
    Selection.Insert Shift:=xlToRight
    Columns("G:G").Select
    Selection.Insert Shift:=xlToRight
    Columns("D:D").Select
    Selection.Replace What:="  ", Replacement:="\", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.TextToColumns Destination:=Range("D1"), DataType:=xlDelimited, _
        TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _
        Semicolon:=False, Comma:=False, Space:=False, Other:=True, OtherChar _
        :="\", FieldInfo:=Array(Array(1, 1), Array(2, 1)), TrailingMinusNumbers:=True
    Selection.NumberFormat = "mm/dd/yy;@"
    With Selection
        .HorizontalAlignment = xlLeft
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    Columns("F:F").Select
    Selection.Replace What:="  ", Replacement:="\", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.TextToColumns Destination:=Range("F1"), DataType:=xlDelimited, _
        TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _
        Semicolon:=False, Comma:=False, Space:=False, Other:=True, OtherChar _
        :="\", FieldInfo:=Array(Array(1, 1), Array(2, 1)), TrailingMinusNumbers:=True
    Selection.NumberFormat = "mm/dd/yy;@"
    With Selection
        .HorizontalAlignment = xlLeft
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    Columns("E:E").Select
    Selection.Insert Shift:=xlToRight
    Columns("H:H").Select
    Selection.Insert Shift:=xlToRight
    Columns("F:F").Select
    Selection.NumberFormat = "[$-409]h:mm AM/PM;@"
    With Selection
        .HorizontalAlignment = xlLeft
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    Columns("I:I").Select
    Selection.NumberFormat = "[$-409]h:mm AM/PM;@"
    With Selection
        .HorizontalAlignment = xlLeft
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With

Do While Application.Worksheets(a).Cells(i, 6).Value <> ""
c = "=(F" & i & ")+TIME(20,0,0)"
Application.Worksheets(a).Cells(i, 5).FormulaLocal = c

i = i + 1

 If i > 10000 Then
 Exit Do
 Else
 End If
 
Loop

Do While Application.Worksheets(a).Cells(j, 9).Value <> ""
d = "=(I" & j & ")+TIME(20,0,0)"
Application.Worksheets(a).Cells(j, 8).FormulaLocal = d

j = j + 1

 If j > 10000 Then
 Exit Do
 Else
 End If
 
Loop

Columns("E:E").Select
   Selection.NumberFormat = "[$-409]h:mm AM/PM;@"

   Selection.Copy
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
       :=False, Transpose:=False
   Columns("H:H").Select
    Selection.NumberFormat = "[$-409]h:mm AM/PM;@"
    Selection.Copy
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
        
    Columns("F:F").Select
    Selection.Delete Shift:=xlToLeft
    Columns("H:H").Select
    Selection.Delete Shift:=xlToLeft

' second part

    Columns("A:A").Select
    With Selection
        .HorizontalAlignment = xlLeft
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    Columns("B:B").Select
    Selection.Delete Shift:=xlToLeft
    ActiveCell.FormulaR1C1 = "Requester"
    Columns("L:L").Select
    Selection.Delete Shift:=xlToLeft
    Selection.Delete Shift:=xlToLeft
    Selection.Delete Shift:=xlToLeft
    Selection.Delete Shift:=xlToLeft
    Selection.Delete Shift:=xlToLeft
    Columns("O:O").Select
    Selection.Delete Shift:=xlToLeft
    Columns("P:P").Select
    Selection.Delete Shift:=xlToLeft
    Selection.Delete Shift:=xlToLeft
    Selection.Delete Shift:=xlToLeft
    '------------Modified After Standard change fied-----------
    Columns("U:U").Select
    Selection.Cut
    Columns("AG:AG").Select
    Selection.Insert Shift:=xlToRight
    Columns("P:AB").Select
    Selection.Delete Shift:=xlToLeft
    '------------Modified After Standard change fied-----------
    Columns("G:G").Select
    Selection.Delete Shift:=xlToLeft
    Columns("G:G").Select
    Selection.Delete Shift:=xlToLeft
    Columns("I:I").Select
    Selection.Cut
    Columns("B:B").Select
    Selection.Insert Shift:=xlToRight
    Columns("N:N").Select
    Selection.Cut
    Columns("C:C").Select
    Selection.Insert Shift:=xlToRight
    Columns("K:K").Select
    Selection.Cut
    Columns("D:D").Select
    Selection.Insert Shift:=xlToRight
   Columns("J:J").Select
    Selection.Cut
    Columns("E:E").Select
    Selection.Insert Shift:=xlToRight
 Columns("F:F").Select
    Selection.Insert Shift:=xlToRight
 Columns("F:F").Select
    Selection.Insert Shift:=xlToRight
Columns("M:M").Select
    Selection.Cut
    Columns("H:H").Select
    Selection.Insert Shift:=xlToRight
Columns("P:P").Select
    Selection.Cut
    Columns("I:I").Select
    Selection.Insert Shift:=xlToRight
Columns("J:J").Select
    Selection.Cut
    Columns("Q:Q").Select
    Selection.Insert Shift:=xlToRight

Columns("H:H").Select
    Selection.Delete Shift:=xlToLeft
Columns("P:P").Select
    Selection.Cut
    Columns("H:H").Select
    Selection.Insert Shift:=xlToRight



    Cells.Select
    Selection.Sort Key1:=Range("J2"), Order1:=xlAscending, Header:=xlYes, _
        OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _
        DataOption1:=xlSortNormal
Dim Rng As Range, Cl As Range
Set Rng = Range(Range("D1"), Range("D" & Rows.Count).End(xlUp))

For Each Cl In Rng
  
  If Cl = "Major" Then
       With Cl.Font
           .Bold = True
           .ColorIndex = 3
       End With
   End If

Next Cl

Dim Rng1 As Range, El As Range
Set Rng1 = Range(Range("N1"), Range("N" & Rows.Count).End(xlUp))

For Each El In Rng1
  
  If El = "Emergency" Then
       With El.Font
           .Bold = True
           .ColorIndex = 3
       End With
   End If

Next El

Dim Rng2 As Range, Fl As Range
Set Rng2 = Range(Range("I1"), Range("I" & Rows.Count).End(xlUp))

For Each Fl In Rng2
  
  If Fl = "" Then
    Fl.Value = "Unassigned"
       With Fl.Font
           
           .ColorIndex = 3
       End With
   End If

Next Fl

Dim Rng3 As Range, Gl As Range
Set Rng3 = Range(Range("H1"), Range("H" & Rows.Count).End(xlUp))

For Each Gl In Rng3
  
  If Gl <> "" Then
    
       With Gl.Font
           
           .ColorIndex = 3
       End With
   End If

Next Gl

Dim rng4 As Range


w1 = "Submitted"


Do
        Set rng4 = Columns("P").Find(w1)
        If rng4 Is Nothing Then
            Exit Do
        Else
            Rows(rng4.Row).Delete
        End If
    Loop
Dim rng5 As Range


w2 = "ReSubmitted"


Do
        Set rng5 = Columns("P").Find(w2)
        If rng5 Is Nothing Then
            Exit Do
        Else
            Rows(rng5.Row).Delete
        End If
    Loop
    '------------Modified After Standard change fied-----------
    Columns("R:R").Select
    Selection.Cut
    Columns("H:H").Select
    Selection.Insert Shift:=xlToRight
    '------------Modified After Standard change fied-----------
End Sub
Private Sub EST()
MsgBox "You have selected EST"
'
' Macro1 Macro
' Macro recorded 11/3/2009 by jakhoon
' Updated 11/20/2012 by jakhoon
' Updated 01/22/2014 by jakhoon

'
Dim i As Integer
Dim a, c As String

a = ActiveSheet.Name
i = 2
j = 2
k = 2


    Columns("D:D").Select
    Selection.Delete Shift:=xlToLeft
    Columns("D:D").EntireColumn.AutoFit
    Columns("E:E").EntireColumn.AutoFit
    Columns("E:E").Select
    Selection.Insert Shift:=xlToRight
    Columns("G:G").Select
    Selection.Insert Shift:=xlToRight
    Columns("D:D").Select
    Selection.Replace What:="  ", Replacement:="\", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.TextToColumns Destination:=Range("D1"), DataType:=xlDelimited, _
        TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _
        Semicolon:=False, Comma:=False, Space:=False, Other:=True, OtherChar _
        :="\", FieldInfo:=Array(Array(1, 1), Array(2, 1)), TrailingMinusNumbers:=True
    Selection.NumberFormat = "mm/dd/yy;@"
    With Selection
        .HorizontalAlignment = xlLeft
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    Columns("F:F").Select
    Selection.Replace What:="  ", Replacement:="\", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.TextToColumns Destination:=Range("F1"), DataType:=xlDelimited, _
        TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _
        Semicolon:=False, Comma:=False, Space:=False, Other:=True, OtherChar _
        :="\", FieldInfo:=Array(Array(1, 1), Array(2, 1)), TrailingMinusNumbers:=True
    Selection.NumberFormat = "mm/dd/yy;@"
    With Selection
        .HorizontalAlignment = xlLeft
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    Columns("E:E").Select
    Selection.Insert Shift:=xlToRight
    Columns("H:H").Select
    Selection.Insert Shift:=xlToRight
    Columns("F:F").Select
    Selection.NumberFormat = "[$-409]h:mm AM/PM;@"
    With Selection
        .HorizontalAlignment = xlLeft
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    Columns("I:I").Select
    Selection.NumberFormat = "[$-409]h:mm AM/PM;@"
    With Selection
        .HorizontalAlignment = xlLeft
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With

Do While Application.Worksheets(a).Cells(i, 6).Value <> ""
c = "=(F" & i & ")+TIME(19,0,0)"
Application.Worksheets(a).Cells(i, 5).FormulaLocal = c

i = i + 1

 If i > 10000 Then
 Exit Do
 Else
 End If
 
Loop

Do While Application.Worksheets(a).Cells(j, 9).Value <> ""
d = "=(I" & j & ")+TIME(19,0,0)"
Application.Worksheets(a).Cells(j, 8).FormulaLocal = d

j = j + 1

 If j > 10000 Then
 Exit Do
 Else
 End If
 
Loop

Columns("E:E").Select
   Selection.NumberFormat = "[$-409]h:mm AM/PM;@"

   Selection.Copy
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
       :=False, Transpose:=False
   Columns("H:H").Select
    Selection.NumberFormat = "[$-409]h:mm AM/PM;@"
    Selection.Copy
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
        
    Columns("F:F").Select
    Selection.Delete Shift:=xlToLeft
    Columns("H:H").Select
    Selection.Delete Shift:=xlToLeft

' second part

    Columns("A:A").Select
    With Selection
        .HorizontalAlignment = xlLeft
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    Columns("B:B").Select
    Selection.Delete Shift:=xlToLeft
    ActiveCell.FormulaR1C1 = "Requester"
    Columns("L:L").Select
    Selection.Delete Shift:=xlToLeft
    Selection.Delete Shift:=xlToLeft
    Selection.Delete Shift:=xlToLeft
    Selection.Delete Shift:=xlToLeft
    Selection.Delete Shift:=xlToLeft
    Columns("O:O").Select
    Selection.Delete Shift:=xlToLeft
    Columns("P:P").Select
    Selection.Delete Shift:=xlToLeft
    Selection.Delete Shift:=xlToLeft
    Selection.Delete Shift:=xlToLeft
   '------------Modified After Standard change fied-----------
    Columns("U:U").Select
    Selection.Cut
    Columns("AG:AG").Select
    Selection.Insert Shift:=xlToRight
    '------------Modified After Standard change fied----------
    Columns("P:AB").Select
    Selection.Delete Shift:=xlToLeft
    Columns("G:G").Select
    Selection.Delete Shift:=xlToLeft
    Columns("G:G").Select
    Selection.Delete Shift:=xlToLeft
    Columns("I:I").Select
    Selection.Cut
    Columns("B:B").Select
    Selection.Insert Shift:=xlToRight
    Columns("N:N").Select
    Selection.Cut
    Columns("C:C").Select
    Selection.Insert Shift:=xlToRight
    Columns("K:K").Select
    Selection.Cut
    Columns("D:D").Select
    Selection.Insert Shift:=xlToRight
   Columns("J:J").Select
    Selection.Cut
    Columns("E:E").Select
    Selection.Insert Shift:=xlToRight
 Columns("F:F").Select
    Selection.Insert Shift:=xlToRight
 Columns("F:F").Select
    Selection.Insert Shift:=xlToRight
Columns("M:M").Select
    Selection.Cut
    Columns("H:H").Select
    Selection.Insert Shift:=xlToRight
Columns("P:P").Select
    Selection.Cut
    Columns("I:I").Select
    Selection.Insert Shift:=xlToRight
Columns("J:J").Select
    Selection.Cut
    Columns("Q:Q").Select
    Selection.Insert Shift:=xlToRight

Columns("H:H").Select
    Selection.Delete Shift:=xlToLeft
Columns("P:P").Select
    Selection.Cut
    Columns("H:H").Select
    Selection.Insert Shift:=xlToRight



    Cells.Select
    Selection.Sort Key1:=Range("J2"), Order1:=xlAscending, Header:=xlYes, _
        OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _
        DataOption1:=xlSortNormal
Dim Rng As Range, Cl As Range
Set Rng = Range(Range("D1"), Range("D" & Rows.Count).End(xlUp))

For Each Cl In Rng
  
  If Cl = "Major" Then
       With Cl.Font
           .Bold = True
           .ColorIndex = 3
       End With
   End If

Next Cl

Dim Rng1 As Range, El As Range
Set Rng1 = Range(Range("N1"), Range("N" & Rows.Count).End(xlUp))

For Each El In Rng1
  
  If El = "Emergency" Then
       With El.Font
           .Bold = True
           .ColorIndex = 3
       End With
   End If

Next El

Dim Rng2 As Range, Fl As Range
Set Rng2 = Range(Range("I1"), Range("I" & Rows.Count).End(xlUp))

For Each Fl In Rng2
  
  If Fl = "" Then
    Fl.Value = "Unassigned"
       With Fl.Font
           
           .ColorIndex = 3
       End With
   End If

Next Fl

Dim Rng3 As Range, Gl As Range
Set Rng3 = Range(Range("H1"), Range("H" & Rows.Count).End(xlUp))

For Each Gl In Rng3
  
  If Gl <> "" Then
    
       With Gl.Font
           
           .ColorIndex = 3
       End With
   End If

Next Gl

Dim rng4 As Range


w1 = "Submitted"


Do
        Set rng4 = Columns("P").Find(w1)
        If rng4 Is Nothing Then
            Exit Do
        Else
            Rows(rng4.Row).Delete
        End If
    Loop
Dim rng5 As Range


w2 = "ReSubmitted"


Do
        Set rng5 = Columns("P").Find(w2)
        If rng5 Is Nothing Then
            Exit Do
        Else
            Rows(rng5.Row).Delete
        End If
    Loop
'------------Modified After Standard change fied
    Columns("R:R").Select
    Selection.Cut
    Columns("H:H").Select
    Selection.Insert Shift:=xlToRight
 '------------Modified After Standard change fied-----------

End Sub

Private Sub SRV_List()
Dim Srv_temp As String
Dim SrvList As String
Sheets.Add After:=Sheets(Sheets.Count)
Sheets("CC-Report-Enterprise Servers").UsedRange.Copy ThisWorkbook.Sheets(Sheets.Count).Cells(1, 1)
ActiveSheet.UsedRange.RemoveDuplicates Columns:=2, Header:=xlNo
Rowcnt = Range("A" & Rows.Count).End(xlUp).Row
Rowinc = 2
SrvList = ""
If ThisWorkbook.Path = "" Then SrvList = Environ("USERPROFILE") & "\Desktop" & "\devicelist.txt"
If ThisWorkbook.Path <> "" Then SrvList = ThisWorkbook.Path & "\devicelist.txt"
Do Until Rowinc = Rowcnt + 1
Srv_temp = Srv_temp & " " & Cells(Rowinc, 2)
Rowinc = Rowinc + 1
Loop
MsgBox SrvList
Open SrvList For Output As #1
Write #1, Srv_temp
Close #1
Sheets(Sheets.Count).Delete
MsgBox "Please use the devicelist.txt file to get the BackupVerification.txt file.After saving the BackupVerification file on to this folder,then press OK "
End Sub


Private Sub Conflict_Report()

' Conflict_Report Macro
' Macro recorded 11/3/2009 by
' Updated 11/20/2012 by
' Updated 01/22/2014 by

Dim MyFile As Variant
Dim Wb2 As Workbook
Dim Ws As Worksheet
Dim Wscnt1 As Integer
Dim Repcnt As Integer
Dim Wscnt As Integer

Repcnt = 1
Repnm = " "
Application.ScreenUpdating = False
Application.DisplayAlerts = False
Wscnt = ThisWorkbook.Worksheets.Count
'If Wscnt > 1 Then
'ThisWorkbook.Worksheets(1).Delete
'ThisWorkbook.Worksheets(2).Delete
'End If
'ActiveSheet.Name = "Report"
Testline:
'-------Open raw data file
Sheets.Add After:=Sheets(Sheets.Count)
ActiveSheet.Name = "Report"
MsgBox "Please Select All-Five Report File(Conflict-Report) "
MyFile = Application.GetOpenFilename()
If MyFile = False Then
MsgBox "No file selected.Please Select RAW data file "
'Exit Sub
GoTo Testline
Else
Workbooks.Open (MyFile)
End If
  '----------File name from path-------
    Flnm = Mid(Mid(MyFile, InStrRev(MyFile, "/") + 1), InStrRev(MyFile, "\") + 1)
    
    '------Copy raw data to report sheet
    Set Wb2 = Application.Workbooks.Open(Flnm)
    ThisWorkbook.Sheets("Report").UsedRange.Clear
    Wb2.Sheets(1).UsedRange.Copy ThisWorkbook.Sheets("Report").Cells(1, 1)
    '---------Close raw data file
    Wb2.Close
Do Until Repcnt = 6
Sheets("Report").Select
    
  Rowcnt = Range("A" & Rows.Count).End(xlUp).Row
    If Repcnt = 1 Then RepType = "NOCCSUN"
    If Repcnt = 2 Then RepType = "CCSW"
    If Repcnt = 3 Then RepType = "CCNOTE"
    If Repcnt = 4 Then RepType = "NOCCDT"
    If Repcnt = 5 Then RepType = "TMCSST"
    
    Repnm = "Rep" & Repcnt
    If Repnm = "Rep1" Then RepTitle = "Do Not Schedule CC on Sundays"
    If Repnm = "Rep2" Then RepTitle = "Must Schedule CC in the same Window"
    If Repnm = "Rep3" Then RepTitle = "Changes with Special instructions during maintenance window"
    If Repnm = "Rep4" Then RepTitle = "Do Not Schedule on Certain Window dates"
    If Repnm = "Rep5" Then RepTitle = "Multiple Changes on the same Server"

    Selection.AutoFilter
    Rowcnt = Range("A" & Rows.Count).End(xlUp).Row
ActiveSheet.Range("$A$1:$U$" & Rowcnt).AutoFilter Field:=1, Criteria1:=RepType
Rowcnt = Range("A" & Rows.Count).End(xlUp).Row
Range("A1:U" & Rowcnt).Select
Selection.Copy
Sheets.Add After:=Sheets(Sheets.Count)
ActiveSheet.Name = "Temp"
    Sheets("Temp").Select
    Cells(1, 1).Select
    ActiveSheet.Paste
    'ActiveSheet.Name = RepType
    'Repcnt = Repcnt + 1
    Sheets("Report").Select
    Selection.AutoFilter
    '-----------Rename report rawdata sheet
    'ThisWorkbook.Sheets("temp").Select
    'ActiveSheet.Name = "Report"
    'Wscnt1 = ThisWorkbook.Worksheets.Count
    'If Repcnt = Wscnt1 Then
    'Set Ws = Sheets.Add(After:=Sheets(Worksheets.Count))
    'End If
  
    If Repcnt = 5 Then
    Sheets("temp").Select
    Call TMCSST
      
    ActiveSheet.Name = "Rep5"
    Sheets("report").Delete
    Else
    Call ReportGen
    Sheets("temp").Delete
    End If
    '--------Next Rawdata file
    Repcnt = Repcnt + 1
    
   Loop
   '-----formating TMCSST report
   'ActiveSheet.Name = "Rep5"
   'ActiveCell.EntireRow.Insert
   ActiveSheet.Cells(1, 1).EntireRow.Insert
   ActiveSheet.Range(Cells(1, 1), Cells(1, 7)).Merge
   ActiveSheet.Cells(1, 1) = RepTitle
   ActiveSheet.Range(Cells(1, 1), Cells(1, 7)).Font.Size = 11
   ActiveSheet.Range(Cells(1, 1), Cells(1, 7)).Interior.Color = RGB(102, 102, 153)
   ActiveSheet.Range(Cells(1, 1), Cells(1, 7)).Font.Bold = True
   ActiveSheet.Range(Cells(1, 1), Cells(1, 7)).Font.Color = RGB(255, 255, 255)
   ActiveSheet.Range(Cells(2, 1), Cells(2, 7)).Font.Size = 11
   ActiveSheet.Range(Cells(2, 1), Cells(2, 7)).Interior.Color = RGB(255, 255, 153)
   ActiveSheet.Range(Cells(2, 1), Cells(2, 7)).Font.Bold = True
   Worksheets("Rep5").Move After:=Worksheets("Rep4")
   Call Remsingle
   Call Consol
   Call GlobalReport
   Call Merge_Reports
End Sub
Private Sub ReportGen()
Dim colcnt As Long
Dim sht As Worksheet
Dim Wscnt As Integer
Dim j As Integer
Wscnt = ThisWorkbook.Worksheets.Count

    For j = 1 To Wscnt
    Worksheets(j).Select
    If ActiveSheet.Name = Repnm Then
    MsgBox "The Report sheet already exists, Please Check"
    Exit Sub
    End If
    Next j
   'ActiveSheet.Name = flnm
Set sht = ThisWorkbook.Worksheets("temp")
ThisWorkbook.Worksheets("temp").Select
If IsEmpty(Cells(2, 1).Value) = True Then
      'MsgBox "Cell A1 is empty"
      ThisWorkbook.Sheets("temp").UsedRange.Clear
   End If
If Application.WorksheetFunction.CountA(sht.Cells) = 0 Then
Sheets.Add After:=Sheets(Sheets.Count)
ActiveSheet.Name = Repnm
'Repcnt = Repcnt + 1
Range(Cells(1, 1), Cells(1, 7)).Merge
ActiveSheet.Cells(1, 1).Interior.Color = RGB(102, 102, 153)
ActiveSheet.Cells(1, 1).Value = RepTitle
ActiveSheet.Cells(1, 1).Font.Size = 11
ActiveSheet.Cells(1, 1).Font.Bold = True
ActiveSheet.Cells(1, 1).Font.Color = RGB(255, 255, 255)
ActiveSheet.Cells(2, 1) = "CC"
ActiveSheet.Cells(2, 2) = "Impact"
ActiveSheet.Cells(2, 3) = "Requester"
ActiveSheet.Cells(2, 4) = "Implementer"
ActiveSheet.Cells(2, 5) = "Date"
ActiveSheet.Cells(2, 6) = "Summary"
ActiveSheet.Cells(2, 7) = "Devices"
ActiveSheet.Range(Cells(2, 1), Cells(2, 7)).Font.Size = 11
ActiveSheet.Range(Cells(2, 1), Cells(2, 7)).Font.Bold = True
ActiveSheet.Range(Cells(2, 1), Cells(2, 7)).Interior.Color = RGB(255, 255, 153)
Range(Cells(3, 1), Cells(3, 7)).Merge
ActiveSheet.Cells(3, 1).Interior.Color = RGB(204, 255, 255)
ActiveSheet.Cells(3, 1).Font.Size = 11
ActiveSheet.Cells(3, 1).Font.Bold = True
ActiveSheet.Cells(3, 1) = "None"
ActiveSheet.Cells(3, 1).HorizontalAlignment = xlCenter
Exit Sub
End If
    Rowcnt = ActiveSheet.Range("A" & Rows.Count).End(xlUp).Row
       Cells.Select
    ActiveWorkbook.Worksheets("temp").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("temp").Sort.SortFields.Add Key:=Range("L2:L" & Rowcnt _
       ), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal
    With ActiveWorkbook.Worksheets("temp").Sort
        .SetRange Range("A1:O" & Rowcnt)
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    Selection.AutoFilter
    ActiveSheet.Range("$A$1:$O$" & Rowcnt).AutoFilter Field:=11, Criteria1:=Array( _
        "Disaster Recovery", "Enterprise Servers", "Global Messaging Operations", "Open Systems Database", _
        "SCCM", "SharePoint", "Webhosting"), Operator:=xlFilterValues
    colcnt = sht.UsedRange.Columns(sht.UsedRange.Columns.Count).Column
Selection.Copy
    Sheets.Add After:=Sheets(Sheets.Count)
    ActiveSheet.Name = Repnm
    ActiveSheet.Paste
    Worksheets("temp").AutoFilterMode = False
    Call delcol
    Call shrt_EFG
    Call Makereport1
End Sub

Private Sub Makereport1()
Dim colcnt As Long
Dim Rowcnt As Long
Dim Numofchr As Long
Dim ct As Long

Dim u As Long
Dim Y As Long
Dim cmt As String
Dim sht As Worksheet
Set sht = ThisWorkbook.Worksheets("temp")
colcnt = sht.UsedRange.Columns(sht.UsedRange.Columns.Count).Column
Rowcnt = ActiveSheet.Range("A" & Rows.Count).End(xlUp).Row
'MsgBox rowcnt
t = 1
u = 2
ct = 9
ActiveSheet.Range(Cells(1, 1), Cells(1, 9)).Interior.Color = RGB(255, 255, 153)
ActiveSheet.Range(Cells(1, 1), Cells(1, 9)).Font.Bold = True
ActiveSheet.Range(Cells(1, 1), Cells(1, 9)).Font.Size = 11
Do While u < Rowcnt + 1
cmt = ActiveSheet.Cells(u, ct)
If ActiveSheet.Cells(u, ct) <> ActiveSheet.Cells(u - 1, ct) Then
ActiveSheet.Cells(u, 1).Select
ActiveCell.EntireRow.Insert
ActiveCell.EntireRow.ClearFormats
Range(Cells(u, 1), Cells(u, 9)).Merge

ActiveSheet.Cells(u, 1).Value = cmt
ActiveSheet.Cells(u, 1).Font.Bold = True
ActiveSheet.Cells(u, 1).Font.Size = 11
ActiveSheet.Cells(u, 1).Font.Color = RGB(0, 0, 0)
ActiveSheet.Cells(u, 1).VerticalAlignment = xlJustify

ActiveSheet.Cells(u, 1).Interior.Color = RGB(204, 255, 255)
With ActiveSheet.UsedRange.Borders
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
u = u + 1
Rowcnt = Rowcnt + 1
End If
If ActiveSheet.Cells(u, ct) = ActiveSheet.Cells(u + 1, ct) Then
u = u + 1
End If
u = u + 1
Loop
ActiveSheet.Range(Cells(1, 8), Cells(1, 9)).EntireColumn.Delete
ActiveSheet.UsedRange.Columns.AutoFit
ActiveSheet.Cells(1, 1).Select
ActiveCell.EntireRow.Insert
ActiveCell.EntireRow.ClearFormats
Range(Cells(1, 1), Cells(1, 7)).Merge
ActiveSheet.Cells(1, 1).Interior.Color = RGB(102, 102, 153)
ActiveSheet.Cells(1, 1).Value = RepTitle
ActiveSheet.Cells(1, 1).Font.Size = 11
ActiveSheet.Cells(1, 1).Font.Bold = True
ActiveSheet.Cells(1, 1).Font.Color = RGB(255, 255, 255)
If IsEmpty(Cells(3, 1).Value) = True Then
Range(Cells(3, 1), Cells(3, 7)).Merge
ActiveSheet.Cells(3, 1).Interior.Color = RGB(204, 255, 255)
ActiveSheet.Cells(3, 1).Font.Size = 11
ActiveSheet.Cells(3, 1).Font.Bold = True
ActiveSheet.Cells(3, 1) = "None"
ActiveSheet.Cells(3, 1).HorizontalAlignment = xlCenter
End If
End Sub

Private Sub shrt_EFG()
Rowcnt = ActiveSheet.Range("A" & Rows.Count).End(xlUp).Row
    Cells.Select
    ActiveWorkbook.Worksheets(Repnm).Sort.SortFields.Clear
    ActiveWorkbook.Worksheets(Repnm).Sort.SortFields.Add Key:=Range( _
        "I2:I" & Rowcnt), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortNormal
    ActiveWorkbook.Worksheets(Repnm).Sort.SortFields.Add Key:=Range( _
        "E2:E" & Rowcnt), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortNormal
    ActiveWorkbook.Worksheets(Repnm).Sort.SortFields.Add Key:=Range( _
        "F2:F" & Rowcnt), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortTextAsNumbers
    ActiveWorkbook.Worksheets(Repnm).Sort.SortFields.Add Key:=Range( _
        "G2:G" & Rowcnt), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortNormal
    With ActiveWorkbook.Worksheets(Repnm).Sort
        .SetRange Range("A1:U" & Rowcnt)
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
End Sub

Private Sub delcol()
Dim colcnt As Long
Dim t As Long
t = 1
Dim sht As Worksheet
Set sht = ThisWorkbook.Worksheets("temp")
colcnt = sht.UsedRange.Columns(sht.UsedRange.Columns.Count).Column
'MsgBox colcnt
Do While t < colcnt + 1
'MsgBox ActiveSheet.Cells(1, t)
If ActiveSheet.Cells(1, t) <> "CC" And ActiveSheet.Cells(1, t) <> "Impact" And ActiveSheet.Cells(1, t) <> "Requestor" _
    And ActiveSheet.Cells(1, t) <> "Implementer" And ActiveSheet.Cells(1, t) <> "Schedule Impl Dt (GMT)" _
    And ActiveSheet.Cells(1, t) <> "Summary" And ActiveSheet.Cells(1, t) <> "Devices" And ActiveSheet.Cells(1, t) _
    <> "Functional Area" _
    And ActiveSheet.Cells(1, t) <> "Notes" Then
'MsgBox ActiveSheet.Cells(1, t)
ActiveSheet.Cells(1, t).EntireColumn.Delete
colcnt = colcnt - 1
t = t - 1
End If
t = t + 1
Loop
End Sub

Private Sub Consol()
Dim Ws As Worksheet
Dim Shtcnt As Integer
'MsgBox day1
Call Weekdate1
'MsgBox stdate
'MsgBox endate
Shtcnt = 1
Rowcnt = 0
Set Ws = Sheets.Add(After:=Sheets(Worksheets.Count))
ThisWorkbook.Sheets(ThisWorkbook.Worksheets.Count).Name = "Conflict-Report"
Do Until Shtcnt = ThisWorkbook.Worksheets.Count
    ThisWorkbook.Sheets(Shtcnt).Select
    If ActiveSheet.Name = "CC-Report-Enterprise Servers" Or ActiveSheet.Name = "Global_Report" Then
    Shtcnt = Shtcnt + 1
    Else
    ThisWorkbook.Sheets(Shtcnt).UsedRange.Copy ThisWorkbook.Sheets("Conflict-Report").Cells(Rowcnt + 1, 1)
    ThisWorkbook.Sheets("Conflict-Report").Select
    Rowcnt = ActiveSheet.Range("A" & Rows.Count).End(xlUp).Row
    ' MsgBox Rowcnt
    Shtcnt = Shtcnt + 1
    End If
    Loop
ThisWorkbook.Sheets("Conflict-Report").Select
ActiveSheet.Columns.EntireColumn.AutoFit
ActiveSheet.Cells(1, 1).Select
ActiveCell.EntireRow.Insert
ActiveCell.EntireRow.Insert
ActiveCell.EntireRow.Insert
ActiveCell.EntireRow.Insert
ActiveCell.EntireRow.ClearFormats
Range(Cells(1, 1), Cells(4, 7)).Merge
ActiveSheet.Cells(1, 1).Interior.Color = RGB(204, 255, 255)
ActiveSheet.Cells(1, 1).Value = "Change Control Conflict Report" & Chr(10) & "Start Date: " & stdate & _
"        End Date: " & endate
ActiveSheet.Cells(1, 1).VerticalAlignment = xlCenter
ActiveSheet.Cells(1, 1).HorizontalAlignment = xlCenter
ActiveSheet.Cells(1, 1).Font.Name = "Calibri"
ActiveSheet.Cells(1, 1).Font.Size = 16
ActiveSheet.Cells(1, 1).Font.Bold = True
ActiveSheet.Cells(1, 1).Font.Color = RGB(0, 0, 0)
With ActiveSheet.UsedRange.Borders
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    Call Rowhigh
Call Delrepsheets
Application.DisplayAlerts = True
Application.ScreenUpdating = True
End Sub


Private Sub Delrepsheets()
Dim Ws As Worksheet
For Each Ws In Sheets
Application.DisplayAlerts = False
If Ws.Name <> "Conflict-Report" And Ws.Name <> "CC-Report-Enterprise Servers" And Ws.Name <> "Global_Report" Then Ws.Delete
Next
Application.DisplayAlerts = True
End Sub


Private Sub Rowhigh()
Dim Rowcnt As Long
Dim Numofchr As Long

'MsgBox Rowcnt
For Rowcnt = 1 To ActiveSheet.UsedRange.Rows.Count
ActiveSheet.Cells(Rowcnt, 1).Select
Numofchr = Len(ActiveSheet.Cells(Rowcnt, 1))
If Numofchr > 132 And ActiveSheet.Cells(Rowcnt, 1).Interior.Color = RGB(204, 255, 255) Then ActiveSheet.Cells _
(Rowcnt, 1).RowHeight = 30
If Numofchr <= 132 And ActiveSheet.Cells(Rowcnt, 1).Font.Bold = True Then ActiveSheet.Cells(Rowcnt, 1).RowHeight = 15
If ActiveSheet.Cells(Rowcnt, 1).Font.Bold = False Then ActiveSheet.Cells(Rowcnt, 1).RowHeight = 12.75
ActiveSheet.Cells(Rowcnt, 1).VerticalAlignment = xlJustify
Next
Cells.Replace What:="Requestor", Replacement:="Requester", LookAt:=xlPart _
        , SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
        Cells.Replace What:="Schedule Impl Dt (GMT)", Replacement:="Date", LookAt:=xlPart _
        , SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
Rowcnt = ActiveSheet.Range("A" & Rows.Count).End(xlUp).Row
End Sub

Private Sub TMCSST()
'
' Macro1 Macro
' Macro recorded 11/3/2009 by jakhoon
' Updated 11/20/2012 by jakhoon
' Updated 01/22/2014 by jakhoon

'

Dim Rng As Range
    'Dim what As String
    w1 = "Network"
    w2 = "Mainframe"
    w4 = "EU Server"
    w5 = "initiative"
    w6 = "NA Hardware Implementation"
    w7 = "NIC"
    w8 = "Inhouse Gateways"
    w9 = "APP Change Log"
    w10 = "CMSA Site Mgmt"
    w11 = "Global Fulfillment Impl"
    w12 = "MCAB Informational Event"
    w13 = "SILAS"
    
    Do
        Set Rng = Columns("K").Find(w1)
        If Rng Is Nothing Then
            Exit Do
        Else
            Rows(Rng.Row).Delete
        End If
    Loop
    Do
        Set Rng = Columns("K").Find(w2)
        If Rng Is Nothing Then
            Exit Do
        Else
            Rows(Rng.Row).Delete
        End If
    Loop
    Do
    Set Rng = Columns("K").Find(w4)
            If Rng Is Nothing Then
            Exit Do
        Else
            Rows(Rng.Row).Delete
        End If
    Loop
      Do
    Set Rng = Columns("K").Find(w5)
            If Rng Is Nothing Then
            Exit Do
        Else
            Rows(Rng.Row).Delete
        End If
    Loop
    Do
    Set Rng = Columns("K").Find(w6)
            If Rng Is Nothing Then
            Exit Do
        Else
            Rows(Rng.Row).Delete
        End If
    Loop
    Do
    Set Rng = Columns("K").Find(w7)
            If Rng Is Nothing Then
            Exit Do
        Else
            Rows(Rng.Row).Delete
        End If
    Loop
    Do
    Set Rng = Columns("K").Find(w8)
            If Rng Is Nothing Then
            Exit Do
        Else
            Rows(Rng.Row).Delete
        End If
    Loop
Do
  Set Rng = Columns("K").Find(w9)
            If Rng Is Nothing Then
            Exit Do
        Else
            Rows(Rng.Row).Delete
        End If
    Loop
Do
  Set Rng = Columns("K").Find(w10)
            If Rng Is Nothing Then
            Exit Do
        Else
            Rows(Rng.Row).Delete
        End If
    Loop
Do
  Set Rng = Columns("K").Find(w11)
            If Rng Is Nothing Then
            Exit Do
        Else
            Rows(Rng.Row).Delete
        End If
    Loop
Do
  Set Rng = Columns("K").Find(w12)
            If Rng Is Nothing Then
            Exit Do
        Else
            Rows(Rng.Row).Delete
        End If
    Loop
Do
  Set Rng = Columns("K").Find(w13)
            If Rng Is Nothing Then
            Exit Do
        Else
            Rows(Rng.Row).Delete
        End If
    Loop
    Columns("A:A").Select
    Selection.Delete Shift:=xlToLeft
    Selection.Replace What:="GICC", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    With Selection
        .HorizontalAlignment = xlLeft
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    Columns("B:B").Select
    Selection.Delete Shift:=xlToLeft
    Columns("E:E").Select
    Selection.NumberFormat = "mm/dd/yy;@"
    With Selection
        .HorizontalAlignment = xlLeft
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    Columns("G:G").Select
    Selection.Delete Shift:=xlToLeft
    Columns("H:S").Select
    Selection.Delete Shift:=xlToLeft
    Cells.Select
    Selection.Sort Key1:=Range("E2"), Order1:=xlAscending, Key2:=Range("G2") _
        , Order2:=xlAscending, Header:=xlYes, OrderCustom:=1, MatchCase:=False _
        , Orientation:=xlTopToBottom, DataOption1:=xlSortNormal, DataOption2:= _
        xlSortNormal

r = 1
    myval = ActiveSheet.Cells(r, 7).Value
    While myval <> ""
        While myval = ActiveSheet.Cells(r, 7).Value
            r = r + 1
        Wend
        ActiveSheet.Rows(r).EntireRow.Insert
        r = r + 1
        myval = ActiveSheet.Cells(r, 7).Value

   Wend


End Sub

Private Sub Remsingle()
Call Rem_Mul_Srv
Dim Rowcnt As Long
Dim rwinc As Long
'ActiveSheet("Rep5").Select
rwinc = 3
Rowcnt = ActiveSheet.Range("A" & Rows.Count).End(xlUp).Row
Do Until rwinc = Rowcnt + 1
'MsgBox ActiveSheet.Cells(Rwinc, 7)
If IsEmpty(ActiveSheet.Cells(rwinc - 1, 7)) And IsEmpty(ActiveSheet.Cells(rwinc + 1, 7)) Then
'MsgBox "single line"
rwinc = rwinc - 1
 ActiveSheet.Cells(rwinc, 1).EntireRow.Delete
 ActiveSheet.Cells(rwinc, 1).EntireRow.Delete
 Rowcnt = ActiveSheet.Range("A" & Rows.Count).End(xlUp).Row
 rwinc = rwinc - 1
 Else
' MsgBox "two line"
 If IsEmpty(ActiveSheet.Cells(rwinc, 7)) And IsEmpty(ActiveSheet.Cells(rwinc + 1, 7)) Then
 ActiveSheet.Cells(rwinc, 1).EntireRow.Delete
 Rowcnt = ActiveSheet.Range("A" & Rows.Count).End(xlUp).Row
 rwinc = rwinc - 1
 End If
 End If
 rwinc = rwinc + 1
 If rwinc > Rowcnt Or rwinc = Rowcnt Then Exit Do
Loop
'MsgBox Rowcnt
ActiveSheet.Cells(3, 1).EntireRow.Delete
End Sub

Private Sub Rem_Mul_Srv()
Dim ff As String
Rowcnt = ActiveSheet.Range("a" & Rows.Count).End(xlUp).Row
Rowinc = 3
Do Until Rowinc = Rowcnt + 1
ff = InStr(ActiveSheet.Cells(Rowinc, 7), ",")
If ff <> 0 Then
ActiveSheet.Cells(Rowinc, 1).EntireRow.Delete
Rowcnt = ActiveSheet.Range("a" & Rows.Count).End(xlUp).Row
Rowinc = Rowinc - 1
End If
If ActiveSheet.Cells(Rowinc, 1) = "initiative" Then
ActiveSheet.Cells(Rowinc, 1).EntireRow.Delete
Rowcnt = ActiveSheet.Range("a" & Rows.Count).End(xlUp).Row
Rowinc = Rowinc - 1
End If
If ActiveSheet.Cells(Rowinc, 7) = "initiative" Then
ActiveSheet.Cells(Rowinc, 1).EntireRow.Delete
Rowcnt = ActiveSheet.Range("a" & Rows.Count).End(xlUp).Row
Rowinc = Rowinc - 1
End If
Rowinc = Rowinc + 1
If Rowinc > Rowcnt Then Exit Do
Loop
End Sub
Private Sub Merge_Reports()
Dim FileName As String
Application.ScreenUpdating = False
Application.DisplayAlerts = False
FileName = "ScheduledChangeControl_" & Format(stdate, "ddmmm") & "_" & Format(endate, "ddmmm")
Sheets("CC-Report-Enterprise Servers").Tab.Color = RGB(0, 176, 240)
Sheets("Conflict-Report").Tab.Color = RGB(0, 176, 240)
Sheets("CC-Report-Global").Tab.Color = RGB(0, 176, 240)
Worksheets("Conflict-Report").Move After:=Worksheets("CC-Report-Global")
Call Notification_Lead_Report
Sheets("CC-Report-Enterprise Servers").Activate
ThisWorkbook.SaveAs (FileName & ".xls")
Application.ScreenUpdating = True
Application.DisplayAlerts = True
End Sub



Private Sub GlobalReport()

' GlobalReport Macro
' Macro recorded 11/3/2009 by
' Updated 11/20/2012 by
' Updated 01/22/2014 by

Dim Ws As Worksheet
Dim RowTitle As String
Dim CrntRow As Long


Application.ScreenUpdating = False
Application.DisplayAlerts = False
'Wscnt = ThisWorkbook.Worksheets.Count
'Sheets.Add After:=Sheets(Sheets.Count)
Sheets("Global_report").Select
ActiveSheet.Name = "GlobalRawdata"
ActiveSheet.Cells(1, 39).EntireColumn.Delete

    ThisWorkbook.Sheets("GlobalRawdata").Select
    Call Macro3
    'ThisWorkbook.Sheets(Sheets.Count).UsedRange.Columns.AutoFit
    ActiveSheet.Cells(1, 13).EntireColumn.Delete
    Rowcnt = ActiveSheet.Range("A" & Rows.Count).End(xlUp).Row
    Rowinc = 1
    'ActiveSheet.Cells(2, 1).Select
    'ActiveCell.EntireRow.Insert
    'ActiveCell.EntireRow.ClearFormats
    ActiveSheet.UsedRange.Font.Name = "Calibri"
    ActiveSheet.UsedRange.Font.Size = 11
    Do Until Rowinc = Rowcnt
    RowTitle = ActiveSheet.Cells(Rowinc + 1, 5) & " Region"
    
   ' If ActiveSheet.Cells(Rowinc + 1, 5) = "APA" Then RowTitle = "APA Region"
   ' If ActiveSheet.Cells(Rowinc + 1, 5) = "APA, CMSA, Europe, NA" Then RowTitle = "APA, CMSA, Europe, NA Regions"
   ' If ActiveSheet.Cells(Rowinc + 1, 5) = "APA, NA" Then RowTitle = "APA, NA Region"
   ' If ActiveSheet.Cells(Rowinc + 1, 5) = "APA, Europe" Then RowTitle = "APA, Europe Region"
   ' If ActiveSheet.Cells(Rowinc + 1, 5) = "CMSA" Then RowTitle = "CMSA Region"
   ' If ActiveSheet.Cells(Rowinc + 1, 5) = "CMSA, NA" Then RowTitle = "CMSA, NA Region"
   ' If ActiveSheet.Cells(Rowinc + 1, 5) = "Europe" Then RowTitle = "Europe Region"
   ' If ActiveSheet.Cells(Rowinc + 1, 5) = "NA" Then RowTitle = "NA Regions"
    
    If ActiveSheet.Cells(Rowinc, 5) <> ActiveSheet.Cells(Rowinc + 1, 5) Then
    If Rowinc = 1 Then
    CrntRow = Rowinc
    Else
    CrntRow = Rowinc + 1
    End If
    ActiveSheet.Cells(CrntRow, 1).Select
    ActiveCell.EntireRow.Insert
    ActiveCell.EntireRow.ClearFormats
    Range(Cells(CrntRow, 1), Cells(CrntRow, 12)).Merge
    ActiveSheet.Cells(CrntRow, 1).Value = RowTitle
    ActiveSheet.Cells(CrntRow, 1).Font.Bold = True
    ActiveSheet.Cells(CrntRow, 1).Font.Size = 11
    ActiveSheet.Cells(CrntRow, 1).Font.Color = RGB(0, 0, 0)
    ActiveSheet.Cells(CrntRow, 1).VerticalAlignment = xlJustify

    ActiveSheet.Cells(CrntRow, 1).Interior.Color = RGB(255, 255, 153)
    With ActiveSheet.UsedRange.Borders
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    
    ActiveSheet.Cells(CrntRow + 1, 1).Select
    If Rowinc = 1 Then
    CrntRow = CrntRow + 1
    Else
    ActiveCell.EntireRow.Insert
    CrntRow = CrntRow + 1
    End If
    
    ActiveCell.EntireRow.ClearFormats
    ActiveSheet.Cells(CrntRow, 1).Value = "CC"
    ActiveSheet.Cells(CrntRow, 2).Value = "Requester"
    ActiveSheet.Cells(CrntRow, 3).Value = "Date"
    ActiveSheet.Cells(CrntRow, 4).Value = "Summary"
    ActiveSheet.Cells(CrntRow, 5).Value = "Region"
    ActiveSheet.Cells(CrntRow, 6).Value = "Device/Server"
    ActiveSheet.Cells(CrntRow, 7).Value = "Classification"
    ActiveSheet.Cells(CrntRow, 8).Value = "Impact"
    ActiveSheet.Cells(CrntRow, 9).Value = "Priority"
    ActiveSheet.Cells(CrntRow, 10).Value = "Status"
    ActiveSheet.Cells(CrntRow, 11).Value = "Implementer"
    ActiveSheet.Cells(CrntRow, 12).Value = "Functional Area"
    
    
    ActiveSheet.Range(Cells(CrntRow, 1), Cells(CrntRow, 12)).Font.Bold = True
    ActiveSheet.Range(Cells(CrntRow, 1), Cells(CrntRow, 12)).Font.Size = 11
    ActiveSheet.Range(Cells(CrntRow, 1), Cells(CrntRow, 12)).Font.Color = RGB(255, 255, 255)
    ActiveSheet.Range(Cells(CrntRow, 1), Cells(CrntRow, 12)).VerticalAlignment = xlJustify
    ActiveSheet.Range(Cells(CrntRow, 1), Cells(CrntRow, 12)).Interior.Color = RGB(102, 102, 153)
    
    If Rowinc = 1 Then
    Rowinc = Rowinc + 2
    Else
    Rowinc = Rowinc + 3
    End If
    
    Rowcnt = ActiveSheet.Range("A" & Rows.Count).End(xlUp).Row
    End If
    
    If ActiveSheet.Cells(Rowinc, 5) = ActiveSheet.Cells(Rowinc + 1, 5) Then
    Rowinc = Rowinc + 1
    End If
    
    Loop
    ActiveSheet.Cells(1, 1).Select
    ActiveCell.EntireRow.Insert
    ActiveCell.EntireRow.Insert
    ActiveCell.EntireRow.Insert
    ActiveCell.EntireRow.Insert
    ActiveSheet.Range(Cells(1, 1), Cells(4, 12)).Merge
    ActiveSheet.Cells(1, 1).Interior.Color = RGB(204, 255, 255)
ActiveSheet.Cells(1, 1).Value = "Scheduled Change Control - Global Major Changes" & Chr(10) & "Start Date: " & stdate & _
" End Date: " & endate
ActiveSheet.Cells(1, 1).VerticalAlignment = xlCenter
ActiveSheet.Cells(1, 1).HorizontalAlignment = xlCenter
ActiveSheet.Cells(1, 1).Font.Name = "Calibri"
ActiveSheet.Cells(1, 1).Font.Size = 16
ActiveSheet.Cells(1, 1).Font.Bold = True
ActiveSheet.Cells(1, 1).Font.Color = RGB(0, 0, 0)
With ActiveSheet.UsedRange.Borders
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = xlAutomatic
    End With
    ActiveSheet.UsedRange.Font.Name = "Calibri"
    ActiveSheet.Cells(1, 1).ColumnWidth = 9
ActiveSheet.Cells(1, 2).ColumnWidth = 11
ActiveSheet.Cells(1, 3).ColumnWidth = 9
ActiveSheet.Cells(1, 4).ColumnWidth = 65
ActiveSheet.Cells(1, 5).ColumnWidth = 23
ActiveSheet.Cells(1, 6).ColumnWidth = 16
ActiveSheet.Cells(1, 7).ColumnWidth = 18
ActiveSheet.Cells(1, 8).ColumnWidth = 20
ActiveSheet.Cells(1, 9).ColumnWidth = 18
ActiveSheet.Cells(1, 10).ColumnWidth = 15
ActiveSheet.Cells(1, 11).ColumnWidth = 20
ActiveSheet.Cells(1, 12).ColumnWidth = 30
ActiveSheet.Columns.EntireRow.AutoFit
ActiveSheet.Name = "CC-Report-Global"
End Sub

Private Sub Macro3()
'
' Macro3 Macro
' Macro recorded 11/11/2009 by jakhoon
'

'
    Columns("A:A").Select
    With Selection
        .HorizontalAlignment = xlLeft
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    Columns("B:B").Select
    Selection.Delete Shift:=xlToLeft
   Columns("D:D").Select
    Selection.Delete Shift:=xlToLeft
    Columns("C:C").Select
Selection.Delete Shift:=xlToLeft
 Columns("C:C").Select
    Selection.NumberFormat = "mm/dd/yy;@"
    With Selection
        .HorizontalAlignment = xlLeft
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    Columns("D:D").Select
    Selection.Delete Shift:=xlToLeft
    Columns("D:D").Select
    Selection.Delete Shift:=xlToLeft
     Columns("J:K").Select
    Selection.Delete Shift:=xlToLeft
    Columns("M:M").Select
    Selection.Delete Shift:=xlToLeft
    Columns("N:O").Select
    Selection.Delete Shift:=xlToLeft
Columns("G:H").Select
    Selection.Delete Shift:=xlToLeft
Columns("M:Z").Select
    Selection.Delete Shift:=xlToLeft
Dim Rng As Range, Cl As Range
Set Rng = Range(Range("H1"), Range("H" & Rows.Count).End(xlUp))

For Each Cl In Rng
  
  If Cl = "Major" Then
       With Cl.Font
           .Bold = True
           .ColorIndex = 3
       End With
   End If

Next Cl

Dim Rng1 As Range, El As Range
Set Rng1 = Range(Range("I1"), Range("I" & Rows.Count).End(xlUp))

For Each El In Rng1
  
  If El = "Emergency" Then
       With El.Font
           .Bold = True
           .ColorIndex = 3
       End With
   End If

Next El

Dim Rng2 As Range, Fl As Range
Set Rng2 = Range(Range("K1"), Range("K" & Rows.Count).End(xlUp))

For Each Fl In Rng2
  
  If Fl = "" Then
    Fl.Value = "Unassigned"
       With Fl.Font
           
           .ColorIndex = 3
       End With
   End If

Next Fl
    Cells.Select
    Selection.Sort Key1:=Range("E2"), Order1:=xlAscending, Header:=xlYes, _
        OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _
       DataOption1:=xlSortNormal

Dim rng4 As Range


w1 = "Minor"


Do
        Set rng4 = Columns("H").Find(w1)
        If rng4 Is Nothing Then
            Exit Do
        Else
            Rows(rng4.Row).Delete
        End If
    Loop

Dim rng5 As Range


w2 = "Submitted"


Do
        Set rng5 = Columns("J").Find(w2)
        If rng5 Is Nothing Then
            Exit Do
        Else
            Rows(rng5.Row).Delete
        End If
    Loop
Dim rng6 As Range


w3 = "ReSubmitted"


Do
        Set rng6 = Columns("J").Find(w3)
        If rng6 Is Nothing Then
            Exit Do
        Else
            Rows(rng6.Row).Delete
        End If
    Loop
End Sub


Private Sub Notification_Lead_Report()

' Notification_Lead_Report Macro
' Macro recorded 11/3/2009 by
' Updated 11/20/2012 by
' Updated 01/22/2014 by

Sheets.Add After:=Sheets(Sheets.Count)
ActiveSheet.Name = "Notification-Lead-Report"
ActiveSheet.Cells(1, 1).Interior.Color = RGB(204, 255, 255)
Range(Cells(1, 1), Cells(4, 10)).Merge
ActiveSheet.Cells(1, 1).Value = "Notification Lead Report" & Chr(10) & "Start Date: " _
& stdate & "      End Date: " & endate
ActiveSheet.Cells(1, 1).HorizontalAlignment = xlCenter
ActiveSheet.Cells(1, 1).VerticalAlignment = xlCenter
ActiveSheet.Cells(1, 1).Font.Name = "Calibri"
ActiveSheet.Cells(1, 1).Font.Size = 16
ActiveSheet.Cells(1, 1).RowHeight = 12.75
ActiveSheet.Cells(1, 1).Font.Bold = True
ActiveSheet.Cells(1, 1).Font.Color = RGB(0, 0, 0)
ActiveSheet.Cells(5, 1) = "CC"
ActiveSheet.Cells(5, 2) = "Requester"
ActiveSheet.Cells(5, 3) = "Summary"
ActiveSheet.Cells(5, 4) = "Server"
ActiveSheet.Cells(5, 5) = "Date"
ActiveSheet.Cells(5, 6) = "Status"
ActiveSheet.Cells(5, 7) = "Implementer"
ActiveSheet.Cells(5, 8) = "Notified"
ActiveSheet.Cells(5, 9) = "Days"
ActiveSheet.Cells(5, 10) = "Notification Type"
ActiveSheet.Range(Cells(5, 1), Cells(5, 10)).Interior.Color = RGB(102, 102, 153)
ActiveSheet.Range(Cells(5, 1), Cells(5, 10)).Font.Color = RGB(255, 255, 255)
ActiveSheet.Range(Cells(5, 1), Cells(8, 10)).Font.Bold = True
ActiveSheet.Range(Cells(5, 1), Cells(5, 10)).Font.Size = 11
Range(Cells(6, 1), Cells(6, 10)).Merge
ActiveSheet.Cells(6, 1) = "Functional Area: Enterprise Servers."
Range(Cells(7, 1), Cells(7, 10)).Merge
ActiveSheet.Cells(7, 1) = "Functional Area: Open Systems Database."
Range(Cells(8, 1), Cells(8, 10)).Merge
ActiveSheet.Cells(8, 1) = "Functional Area: Webhosting."
ActiveSheet.Range(Cells(6, 1), Cells(8, 10)).Interior.Color = RGB(204, 255, 255)

With ActiveSheet.UsedRange.Borders
      .LineStyle = xlContinuous
      .Weight = xlThin
      .ColorIndex = xlAutomatic
    End With
    Cells.Select
    Selection.EntireColumn.AutoFit
    Cells(1, 1).Select
End Sub

 Private Sub Stand_Change()
   Dim YesNo As Long
    'Columns("H:H").Select
    'Rowcnt = Range("A" & Rows.Count).End(xlUp).Row
    'YesNo = 7
    'Do Until YesNo = Rowcnt + 1
    
    'If Cells(YesNo, 8) = "y" Or Cells(YesNo, 8) = "Y" Then
    'Cells(YesNo, 8) = "Yes"
    'ActiveSheet.Cells(YesNo, 8).HorizontalAlignment = xlCenter
    
    'End If
    'If Cells(YesNo, 8) = " " Or IsEmpty(Cells(YesNo, 8).Value) = True Or Cells(YesNo, 8) = "n" Then
    'Cells(YesNo, 8) = "No"
   ' ActiveSheet.Cells(YesNo, 8).HorizontalAlignment = xlCenter
    'End If
    'YesNo = YesNo + 1
    
    'If Cells(YesNo, 1).Interior.Color <> RGB(255, 255, 153) And Cells(YesNo, 1).Interior.Color <> RGB(102, 102, 153) Then
    'ActiveSheet.Cells(YesNo, 8).HorizontalAlignment = xlCenter
    'End If
    'Loop
    
End Sub

Private Sub SRVInterrupt()
Sheets("CC-Report-Enterprise Servers").Select
Rowcnt = Range("A" & Rows.Count).End(xlUp).Row
    Range("B1").Select
    Selection.AutoFilter
    ActiveSheet.Range("$A$1:$R$" & Rowcnt).AutoFilter Field:=18, Criteria1:= _
        "=*<*", Operator:= _
        xlOr, Criteria2:="=*>*"
    
    Range("R1").Select
    Range("R2:R" & Rowcnt).Select
    Range(Selection, Selection.End(xlDown)).SpecialCells(xlCellTypeVisible).Select
    'MsgBox ActiveCell.Row
    'MsgBox ActiveCell.Column
    ActiveCell.FormulaR1C1 = "MM"
    Selection.Font.Bold = True
    With Selection.Font
        .Name = "Calibri"
        .FontStyle = "Bold"
        .Size = 11
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .Color = 255
        .TintAndShade = 0
        .ThemeFont = xlThemeFontMinor
    End With
    Range(Selection, Selection.End(xlDown)).Select
    Selection.FillDown
    Range("A1").Select
    Selection.AutoFilter
    Selection.AutoFilter
    ActiveSheet.Range("$A$1:$R$" & Rowcnt).AutoFilter Field:=18, Criteria1:="<>MM", Operator:= _
        xlAnd, Criteria2:="<> "
    Range("R1").Select
    Range("R2:R" & Rowcnt).Select
    Range(Selection, Selection.End(xlDown)).SpecialCells(xlCellTypeVisible).Select
    Range(Selection, Selection.End(xlDown)).SpecialCells(xlCellTypeVisible).Clear
    Range("A1").Select
    Selection.AutoFilter
End Sub





















